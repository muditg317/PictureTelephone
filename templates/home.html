<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>TeleDrawings</title>
  </head>
  <body>
    {% if request == "failed" %}
      <script>
        alert("You were too slow! Someone already edited the thread :(")
      </script>
    {% endif %}
    <div class="nav_bar">
      <!--insert teledrawing icon-->
      <a href="/home">Home</a> <!--tab 1-->
      <a href="/my-threads">My Threads</a><!--tab 2-->
      <a href='/rules'>Rules</a>
      <a href="{{logout_url}}">Log Out</a>
    </div>
    <div class='title_block'>
      <h1>Hi, {{user_info.username}}! Choose a Thread</h1>
    </div>
    <div class="main_body">
      {% if threads|length != 0%}
        <div class='carousel'>
          <!-- Insert Carosuel Here -->
          <figure>
            {% for thread in threads %}
              <div class="thread">
                thread id: <a href="/edit?key={{thread.key.id()}}">{{thread.thread_id}}</a><br>
                {% set edit_list = edits_by_thread[thread.key.id()|string] %}
                {% set edit = edit_list[edit_list|length-1] %}
                  {% set kind = edit.addition.kind() %}
                    {% if kind=="Caption"%}
                      <p class="caption">{{kind}}: {{edit.addition.get().content}}</p>
                    {% else %}
                      {{kind}}: <img class="drawing" src="drawings?key={{edit.addition.id()}}" alt="{{edit.addition.id()}}">
                    {% endif %}
                <br>
              </div>
            {% endfor %}
          </figure>
        </div>
      {% else %}
        <h3>Uh oh! You've bailed on all the threads!</h3>
        <p>Check out the <a href="/my-threads">My Threads</a> tab!</p>
      {% endif %}
    </div>
    <a href="/create">Create a new Thread!</a>
  </body>
</html>
